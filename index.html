<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <title>Covid-19 Assesment</title>
</head>
<style type="text/css">
.required {

    color: red;
}
</style>

<body>
    <div class="container mt-5">
        <div class="row">
            <div class="offset-md-3 col-md-6">
                <div class="card">
                    <div class="card-header text-center">
                        COVID-19 SELF ASSESMENT
                    </div>
                    <div class="card-body d-blok" id="step1">
                        <h3 class="text-center"> Step One</h3>
                        <hr>
                        <div class="form-group mb-3">
                            <label>Your Name <span id="name_error"></span> </label>
                            <input type="text" class="form-control" id="name" aria-label="Username">
                        </div>
                        <div class="form-group mb-3">
                            <label>Age <span id="age_error"></span> </label>
                            <input type="number" class="form-control" id="age" aria-label="Username">
                        </div>
                        <div class="form-group mb-3">
                            <label> Gender <span id="gender_error"></span></label>
                            <select class="form-control" id="gender">
                                <option value=""> Select Gender</option>
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                                <option value="others">Others</option>
                            </select>
                        </div>
                        <div class="form-group mb-3">
                            <label>Tempature <span id="temp_error"></span> </label>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <select class="form-control" id="temp-type">
                                        <option value="f">F</option>
                                        <option value="c">C</option>
                                    </select>
                                </div>
                                <input type="number" class="w-50 form-control" id="temp" aria-label="Username">
                            </div>
                        </div>
                        <div class="form-group mb-3 text-right">
                            <input type="button" class="btn btn-primary" id="infoBtn" value="NEXT">
                        </div>
                    </div>
                    <div class="card-body d-none" id="step2">
                        <h3 class="text-center"> Step Two</h3>
                        <hr>
                        <input type="checkbox" id="breathing" name="symtomps" value="Breathing">
                        <label for="breathing">Breathing problem</label><br>
                        <input type="checkbox" id="cough" name="symtomps" value="Cough">
                        <label for="cough"> Dry cough</label><br>
                        <input type="checkbox" id="throat" name="symtomps" value="Throat">
                        <label for="throat"> Sore throat</label><br>
                        <input type="checkbox" id="weakness" name="symtomps" value="Weakness">
                        <label for="weakness"> Weakness</label><br>
                        <input type="checkbox" id="nose" name="symtomps" value="Nose">
                        <label for="nose"> Runny nose</label><br><br>
                        <div class="form-group mb-3 text-right">
                            <input type="button" class="btn btn-primary" id="symptom_btn" value="NEXT">
                        </div>
                    </div>

                    <div class="card-body d-none" id="step3">
                        <h3 class="text-center"> Step Three</h3>
                        <hr>
                        <input type="checkbox" id="abdominal" name="add_symp" value="Abdominal">
                        <label for="abdominal"> Abdominal pain</label><br>
                        <input type="checkbox" id="vomiting" name="add_symp" value="Vomiting">
                        <label for="vomiting"> Vomiting</label><br>
                        <input type="checkbox" id="diarrhoea" name="add_symp" value="Biarrhoea">
                        <label for="diarrhoea">Diarrhoea</label><br>
                        <input type="checkbox" id="pressure" name="add_symp" value="Pressure">
                        <label for="pressure"> Chest pain or pressure</label><br>
                        <input type="checkbox" id="muscle" name="add_symp" value="Muscle">
                        <label for="muscle"> Muscle pain</label><br>
                        <input type="checkbox" id="smell" name="add_symp" value="Smell">
                        <label for="smell"> Loss of taste or smell</label><br>
                        <input type="checkbox" id="discoloration" name="add_symp" value="Discoloration">
                        <label for="discoloration"> Rash on skin, or discoloration of fingers or toes</label><br>
                        <input type="checkbox" id="speech" name="add_symp" value="Speech">
                        <label for="speech"> Loss of speech or movement</label><br><br>
                        <div class="form-group mb-3 text-right">
                            <input type="button" class="btn btn-primary" id="add_symptom_btn" value="NEXT">
                        </div>

                    </div>

                     <div class="card-body d-none" id="step4">
                        <h3 class="text-center"> Result</h3>
                        <hr>
                        <div>
                            <h1 id="result" style="font-weight: bold;"></h1>
                        </div>
                       
              
                    </div>

                </div>
            </div>
        </div>
    </div>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
    <script type="text/javascript">
    var points = 0;
    var points_2 = 0;
    var points_3 = 0;
    var name = "";
    var age = "";
    var gender = "";
    var temp = "";
    var temp_type = "";
    var add_syymptom = [];

    $("#infoBtn").on("click", function() {

        var success = true;

        $("span").html('');

        var errors = {};

        name = $("#name").val();
        age = $("#age").val();
        gender = $("#gender option:selected").val();
        temp_type = $("#temp-type option:selected").val();
        temp = $("#temp").val();


        //name validation
        if (name == "") {

            errors.name = "required";
            success = false;

        }

        //gender validation

        if (gender == "") {

            errors.gender = "required";
            success = false;

        }


        //age vlidation
        if (age == "") {

            errors.age = "required";
            success = false;

        }

        if (!Number(age)) {

            errors.age = "Must be a number";
            success = false;

        }

        if (age > 120 || age < 0) {

            errors.age = "Number must be between 1 - 120";
            success = false;

        }

        //temp validation

        if (temp == "") {

            errors.temp = "required";
            success = false;

        }

        if (temp_type == "f") {

            if (temp < 90) {

                errors.temp = "Temparature must be greter than 90";
                success = false;
            }

        }

        if (temp_type == "c") {

            if (temp > 45) {

                errors.temp = "Temparature must be smaller than 40";
                success = false;
            }

        }


        if (success) {

            if (temp_type == "f" && temp > 100.9) {

                points = 2;
            }

            if (temp_type == "c" && temp > 38.3) {

                points = 2;
            }

            show("step2")
            hide("step1");



        } else {


            for (var k in errors) {

                if (errors.hasOwnProperty(k)) {

                    $("#" + k + '_error').addClass("required").html(errors[k]);

                }
            };
        }


    });

    $("#symptom_btn").on("click", function(){

        var p = points;
        var n = 0;
        var s_value = 0;
        var symptom = [];

        $('input[name="symtomps"]:checked').each(function() {

            if(!symptom.includes($(this).val())) {

              symptom.push($(this).val());
            }

        });

        if(symptom.length == 0) {

             alert("please select symptoms");

        } else {

            var c = confirm('Are you sure want to go to next');

            if(c) {

                if(symptom.length > 1) {

                    s_value  = 3+(symptom.length - 1);


                } else {

                    s_value = 3;
                }

                n = p+s_value;

                points_2 = n;

                show('step3');
                hide('step2');

            }

        }

       


    });

    $("#add_symptom_btn").on("click", function(){

        var p = points_2;
        var n = 0;
        var s_value = 0;
        var symptom = [];

        $('input[name="add_symp"]:checked').each(function() {

            if(!symptom.includes($(this).val())) {

              symptom.push($(this).val());
            }

        });

        if(symptom.length == 0) {

             alert("please select symptoms");

        } else {

            var c = confirm('Are you sure want to go to result');

            if(c) {

                
                s_value  = (symptom.length)*2;

                n = p+s_value;
                points_3 = n;

                show('step4');
                hide('step3');


            }

        }

      

    });

    function show(e) {

        $("#" + e).removeClass('d-none').addClass('d-block');

        if(e == "step4") {


            var r = "Undefined";

             if(points_3 < 5) {

                r = '<span style="color: green"> Merely have chance to get affected by COVID-19, please contact doctor </span>';
             }

             if(points_3 == 5) {

                r = '<span style="color: yellow">  Possible suspected case for COVID-19 affected, isolation </span>';
             }


             if(points_3 > 5 && points_3 < 7) {

                r = '<span style="color: red">  Highly chance of COVID-19 affected </span>';
             }


            if(points_3 > 7) {

                r = '<span style="color: red"> Almost confirmed case of COVID-19 positive </span>';
             }

             $("#result").html(r);

             var data = {

                name: name,
                age: age,
                gender: gender,
                temp: temp,
                temp_type: temp_type,
                points: points_3,
                r: r,
             };

            var  d  = new FormData();

            d.append('item', JSON.stringify(data));

            $.ajax({

                type: 'POST',
                url: 'send.php',
                data: d,
                contentType: false,
                cache: true,
                processData: false

            })
            .done(function(data) {

                 console.log(data);
            })

            .fail(function(xhr, status, error, req) {
                // just in case posting your form failed
                

                if (xhr.readyState == 0) {

                    //noServer();

                } else {

                    console.log(xhr.responseText);
                    scriptError(error);

                }

            });



        }
    }

    function hide(e) {

        $("#" + e).removeClass('d-block').addClass('d-none')
    }
    </script>
</body>

</html>